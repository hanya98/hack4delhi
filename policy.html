<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JanSetu | Policymaker Module</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <script>
        // Tailwind Dark Mode Configuration
        tailwind.config = {
            darkMode: 'class',
        }
    </script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
        body { font-family: 'Inter', sans-serif; transition: background-color 0.3s ease; }
        
        .glass-card { 
            background: rgba(255, 255, 255, 0.9); 
            backdrop-filter: blur(10px); 
            border: 1px solid rgba(226, 232, 240, 0.8); 
            transition: all 0.3s ease; 
        }
        .dark .glass-card { 
            background: rgba(30, 41, 59, 0.7); 
            border: 1px solid rgba(71, 85, 105, 0.4); 
        }
        
        .nav-active { border-right: 4px solid #2563eb; background: #eff6ff; color: #2563eb; font-weight: 600; }
        .dark .nav-active { background: rgba(37, 99, 235, 0.1); color: #60a5fa; border-right-color: #60a5fa; }
    </style>
    <link rel="stylesheet" href="jansetu-assistant.css">

<div id="voice-overlay"></div>
<button class="voice-btn" id="voiceBtn" onclick="startListening()">ðŸŽ¤</button>
</head>
<body class="flex min-h-screen bg-slate-50 dark:bg-slate-900 text-slate-900 dark:text-slate-100">

    <aside class="w-64 bg-white dark:bg-slate-800 border-r dark:border-slate-700 flex flex-col fixed h-full transition-all z-20">
        <div class="p-6">
            <h1 class="text-2xl font-bold text-blue-700 dark:text-blue-400 flex items-center gap-2">
                </i> JanSetu
            </h1>
            <p class="text-xs text-gray-500 dark:text-slate-400 font-medium tracking-widest mt-1 uppercase">Policymaker Suite</p>
        </div>

        <div class="px-6 mb-4">
            <button onclick="toggleDarkMode()" class="flex items-center gap-3 w-full p-2 rounded-xl bg-slate-100 dark:bg-slate-700 text-sm font-medium transition-all">
                <span class="dark:hidden flex items-center gap-2"><i data-lucide="moon" class="w-4 h-4"></i> Dark Mode</span>
                <span class="hidden dark:flex items-center gap-2"><i data-lucide="sun" class="w-4 h-4"></i> Light Mode</span>
            </button>
        </div>

        <nav class="flex-1 px-4 space-y-2">
            <button onclick="showPage('overview')" id="btn-overview" class="w-full flex items-center gap-3 px-4 py-3 text-gray-600 dark:text-slate-300 rounded-lg hover:bg-gray-50 dark:hover:bg-slate-700 nav-active">
                <i data-lucide="layout-dashboard" class="w-5 h-5"></i> Overview
            </button>
            <button onclick="showPage('grievances')" id="btn-grievances" class="w-full flex items-center gap-3 px-4 py-3 text-gray-600 dark:text-slate-300 rounded-lg hover:bg-gray-50 dark:hover:bg-slate-700">
                <i data-lucide="message-square" class="w-5 h-5"></i> Complaints Insights
            </button>
            <button onclick="showPage('impact')" id="btn-impact" class="w-full flex items-center gap-3 px-4 py-3 text-gray-600 dark:text-slate-300 rounded-lg hover:bg-gray-50 dark:hover:bg-slate-700">
                <i data-lucide="trending-up" class="w-5 h-5"></i> Policy Impact
            </button>
            <button onclick="showPage('reports')" id="btn-reports" class="w-full flex items-center gap-3 px-4 py-3 text-gray-600 dark:text-slate-300 rounded-lg hover:bg-gray-50 dark:hover:bg-slate-700">
                <i data-lucide="file-text" class="w-5 h-5"></i> Report Center
            </button>
                        <button onclick="showPage('reports')" id="btn-reports" class="w-full flex items-center gap-3 px-4 py-3 text-gray-600 dark:text-slate-300 rounded-lg hover:bg-gray-50 dark:hover:bg-slate-700">
                <i data-lucide="file-text" class="w-5 h-5"></i> <a href="geomint.html">Geomint Dashboard</a>
            </button>
        </nav>

        <div class="p-4 border-t dark:border-slate-700">
            <div class="flex items-center gap-3 p-2">
                <div class="w-10 h-10 rounded-full bg-blue-100 dark:bg-blue-900 flex items-center justify-center text-blue-700 dark:text-blue-300 font-bold">NB</div>
                <div>
                    <p class="text-sm font-semibold">Sh. Nishant Bodh</p>
                    <p class="text-xs text-gray-500 dark:text-slate-400">District Magistrate</p>
                </div>
            </div>
        </div>
    </aside>

    <main class="ml-64 flex-1 p-8">
        
        <header class="flex justify-between items-center mb-8">
            <div>
                <h2 id="page-title" class="text-3xl font-bold text-gray-800 dark:text-white">Policymaker Analytics Dashboard</h2>
                <p class="text-gray-500 dark:text-slate-400">Real-time governance oversight and decision support.</p>
            </div>
            <div class="flex gap-4">
                <select class="bg-white dark:bg-slate-800 border dark:border-slate-600 rounded-lg px-4 py-2 text-sm shadow-sm outline-none">
                    <option>All Districts</option>
                    <option>Central Delhi</option>
                    <option>New Delhi</option>
                    <option>East Delhi</option>
                    <option>Central North Delhi</option>
                    <option>North Delhi</option>
                    <option>North East Delhi</option>
                    <option>North West Delhi</option>
                    <option>Old Delhi</option>
                    <option>Outer North Delhi</option>
                    <option>South Delhi</option>
                    <option>South East Delhi</option>
                    <option>South West Delhi</option>
                    <option>West Delhi</option>
                </select>
                <div class="flex bg-white dark:bg-slate-800 border dark:border-slate-600 rounded-lg p-1 shadow-sm">
                    <button id="range-30" onclick="toggleDateRange(30)" class="px-4 py-1 text-sm bg-blue-50 text-blue-600 dark:bg-blue-900 dark:text-blue-200 rounded-md font-medium transition-all">30 Days</button>
                    <button id="range-90" onclick="toggleDateRange(90)" class="px-4 py-1 text-sm text-gray-500 dark:text-slate-400 transition-all">90 Days</button>
                </div>
            </div>
        </header>

        <section id="page-overview" class="page-section space-y-8">
            <div class="grid grid-cols-1 md:grid-cols-4 gap-6">
                <div class="glass-card p-6 rounded-2xl">
                    <div class="flex justify-between items-start">
                        <div class="p-2 bg-blue-100 dark:bg-blue-900/40 text-blue-600 dark:text-blue-400 rounded-lg"><i data-lucide="users"></i></div>
                        <span class="text-green-500 text-xs font-bold flex items-center gap-1">â†‘ 12%</span>
                    </div>
                    <h3 id="stat-total" class="text-3xl font-bold mt-4">0</h3>
                    <p class="text-gray-500 dark:text-slate-400 text-sm">Total Complaints</p>
                </div>
                <div class="glass-card p-6 rounded-2xl border-l-4 border-orange-400">
                    <div class="flex justify-between items-start">
                        <div class="p-2 bg-orange-100 dark:bg-orange-900/40 text-orange-600 dark:text-orange-400 rounded-lg"><i data-lucide="alert-circle"></i></div>
                        <span class="text-red-500 text-xs font-bold flex items-center gap-1">Critical</span>
                    </div>
                    <h3 id="stat-priority" class="text-3xl font-bold mt-4">0</h3>
                    <p class="text-gray-500 dark:text-slate-400 text-sm">High Priority Issues</p>
                </div>
                <div class="glass-card p-6 rounded-2xl">
                    <div class="flex justify-between items-start">
                        <div class="p-2 bg-green-100 dark:bg-green-900/40 text-green-600 dark:text-green-400 rounded-lg"><i data-lucide="briefcase"></i></div>
                    </div>
                    <h3 id="stat-schemes" class="text-3xl font-bold mt-4">0</h3>
                    <p class="text-gray-500 dark:text-slate-400 text-sm">Active Schemes</p>
                </div>
                <div class="glass-card p-6 rounded-2xl">
                    <div class="flex justify-between items-start">
                        <div class="p-2 bg-purple-100 dark:bg-purple-900/40 text-purple-600 dark:text-purple-400 rounded-lg"><i data-lucide="smile"></i></div>
                        <span class="text-blue-500 text-xs font-bold">Target 4.5</span>
                    </div>
                    <h3 class="text-3xl font-bold mt-4">4.2<span class="text-lg text-gray-400">/5</span></h3>
                    <p class="text-gray-500 dark:text-slate-400 text-sm">Citizen Satisfaction</p>
                </div>
            </div>

            <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                <div class="glass-card p-6 rounded-2xl">
                    <h4 class="font-bold mb-4">Complaints Density Heatmap (Simulated)</h4>
                    <div class="h-64 bg-slate-50 dark:bg-slate-800/50 rounded-xl flex items-center justify-center border-2 border-dashed border-slate-200 dark:border-slate-700">
                        <div class="text-center group cursor-pointer">
                            <i data-lucide="map" class="w-12 h-12 text-slate-300 dark:text-slate-600 mx-auto mb-2 group-hover:text-blue-400 transition-colors"></i>
                            <p class="text-slate-400 dark:text-slate-500 text-sm italic">Hover to explore district-wise hotspots</p>
                        </div>
                    </div>
                </div>
                <div class="glass-card p-6 rounded-2xl">
                    <h4 class="font-bold mb-4">Complaint Trends (Interactive)</h4>
                    <canvas id="overviewChart" height="150"></canvas>
                </div>
            </div>
        </section>

        <section id="page-grievances" class="page-section hidden space-y-8">
            <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                <div class="glass-card p-6 rounded-2xl col-span-1 text-center">
                    <h4 class="font-bold mb-4">Complaint Categories (Click Legend to Toggle)</h4>
                    <canvas id="categoryChart"></canvas>
                </div>
                <div class="glass-card p-6 rounded-2xl col-span-2">
                    <div class="flex justify-between items-center mb-6">
                        <h4 class="font-bold text-lg">Recurring Complaints & Crowd Priority</h4>
                        <div class="relative">
                            <i data-lucide="search" class="w-4 h-4 absolute left-3 top-2.5 text-gray-400"></i>
                            <input type="text" id="complaintSearch" onkeyup="filterComplaints()" placeholder="Search ward or issue..." class="pl-10 pr-4 py-2 border dark:border-slate-600 dark:bg-slate-800 rounded-xl text-sm outline-none focus:ring-2 focus:ring-blue-500 w-64">
                        </div>
                    </div>
                    <table class="w-full text-left" id="complaintsTable">
                        <thead class="text-gray-400 dark:text-slate-500 text-xs uppercase tracking-wider border-b dark:border-slate-700">
                            <tr>
                                <th class="pb-3">Complaint Type</th>
                                <th class="pb-3">Ward Number</th>
                                <th class="pb-3">Public Support</th>
                                <th class="pb-3 text-right">Action</th>
                            </tr>
                        </thead>
                        <tbody class="text-sm divide-y dark:divide-slate-700">
                            <tr class="hover:bg-gray-50 dark:hover:bg-slate-700/50 transition-colors">
                                <td class="py-4 font-medium">Intermittent Power Outage</td>
                                <td class="py-4">28N</td>
                                <td class="py-4"><span class="bg-blue-600 text-white text-[10px] px-2 py-0.5 rounded-full">Score: 94</span></td>
                                <td class="py-4 text-right text-blue-600 dark:text-blue-400 font-semibold cursor-pointer">View Case</td>
                            </tr>
                            <tr class="hover:bg-gray-50 dark:hover:bg-slate-700/50 transition-colors">
                                <td class="py-4 font-medium">Water Pipeline Leakage</td>
                                <td class="py-4">2N</td>
                                <td class="py-4"><span class="bg-blue-600 text-white text-[10px] px-2 py-0.5 rounded-full">Score: 88</span></td>
                                <td class="py-4 text-right text-blue-600 dark:text-blue-400 font-semibold cursor-pointer">View Case</td>
                            </tr>
                            <tr class="hover:bg-gray-50 dark:hover:bg-slate-700/50 transition-colors">
                                <td class="py-4 font-medium">Garbage Collection Delay</td>
                                <td class="py-4">29N</td>
                                <td class="py-4"><span class="bg-blue-400 text-white text-[10px] px-2 py-0.5 rounded-full">Score: 65</span></td>
                                <td class="py-4 text-right text-blue-600 dark:text-blue-400 font-semibold cursor-pointer">View Case</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </section>

        <section id="page-impact" class="page-section hidden space-y-8">
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                <div class="glass-card p-6 rounded-2xl border-t-4 border-green-500">
                    <h5 class="font-bold">Swachh District Plan</h5>
                    <p class="text-xs text-gray-400 mt-1">Target: Sanitation</p>
                    <div class="mt-4 flex items-end gap-2">
                        <span class="text-2xl font-bold text-green-600">82%</span>
                        <span class="text-xs text-gray-500 mb-1">Coverage Achieved</span>
                    </div>
                    <div class="w-full bg-gray-100 dark:bg-slate-700 h-2 rounded-full mt-2">
                        <div class="bg-green-500 h-2 rounded-full" style="width: 82%"></div>
                    </div>
                </div>
                <div id="ai-card" class="glass-card p-6 rounded-2xl col-span-2 bg-gradient-to-br from-blue-50 to-white dark:from-slate-800 dark:to-slate-900 border-blue-100 dark:border-blue-900/30 transition-all duration-500">
                    <div class="flex items-center justify-between mb-2">
                        <div class="flex items-center gap-2 text-blue-700 dark:text-blue-400 font-bold">
                            <i data-lucide="sparkles" class="w-5 h-5"></i> AI-Generated Policy Insight
                        </div>
                        <button onclick="runAISimulation()" class="text-xs bg-blue-600 text-white px-3 py-1 rounded-lg hover:bg-blue-700 transition">Analyze Live Trends</button>
                    </div>
                    <div id="ai-text-container">
                        <p class="text-gray-700 dark:text-slate-300 text-sm leading-relaxed italic">
                            Click the button to run a cross-departmental impact analysis...
                        </p>
                    </div>
                </div>
            </div>
            <div class="glass-card p-8 rounded-2xl">
                <h4 class="font-bold mb-6">Impact Analysis: Complaints (Before vs After Scheme)</h4>
                <canvas id="impactChart" height="100"></canvas>
            </div>
        </section>

        <section id="page-reports" class="page-section hidden">
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                <div class="glass-card p-6 rounded-2xl">
                    <h4 class="font-bold mb-6">Report Parameters</h4>
                    <div class="space-y-4">
                        <div>
                            <label class="text-xs font-bold text-gray-400 block mb-1">SELECT DISTRICT</label>
                            <select id="reportDistrict" class="w-full border dark:border-slate-600 dark:bg-slate-800 rounded-lg p-2 text-sm">
                                <option>Central Delhi</option>
                                <option>New Delhi</option>
                                <option>East Delhi</option>
                                <option>Central North Delhi</option>
                                <option>North Delhi</option>
                                <option>North East Delhi</option>
                                <option>North West Delhi</option>
                                <option>Old Delhi</option>
                                <option>Outer North Delhi</option>
                                <option>South Delhi</option>
                                <option>South East Delhi</option>
                                <option>South West Delhi</option>
                                <option>West Delhi</option>
                            </select>
                        </div>
                        <div>
                            <label class="text-xs font-bold text-gray-400 block mb-1">REPORT TITLE</label>
                            <input type="text" id="reportName" value="Governance Performance Report" class="w-full border dark:border-slate-600 dark:bg-slate-800 rounded-lg p-2 text-sm outline-none">
                        </div>
                        <div>
                            <label class="text-xs font-bold text-gray-400 block mb-1">DATE RANGE</label>
                            <div class="grid grid-cols-2 gap-2">
                                <input type="date" id="reportDateStart" class="border dark:border-slate-600 dark:bg-slate-800 rounded-lg p-2 text-sm" value="2025-12-01">
                                <input type="date" id="reportDateEnd" class="border dark:border-slate-600 dark:bg-slate-800 rounded-lg p-2 text-sm" value="2025-12-28">
                            </div>
                        </div>
                        <button onclick="generateLiveReport()" class="w-full bg-blue-600 text-white py-3 rounded-xl font-bold mt-4 shadow-lg shadow-blue-200 hover:bg-blue-700 transition-colors">
                            Generate Policy Report
                        </button>
                    </div>
                </div>
                <div class="lg:col-span-2 glass-card p-8 rounded-2xl bg-slate-50 dark:bg-slate-900/50 border-dashed border-2 dark:border-slate-700">
                    <div id="report-preview" class="bg-white dark:bg-slate-800 p-8 rounded shadow-sm border dark:border-slate-700 h-[550px] overflow-y-auto relative transition-all">
                        <div class="flex flex-col items-center justify-center h-full text-slate-400" id="empty-report-state">
                            <i data-lucide="file-text" class="w-16 h-16 mb-4 opacity-20"></i>
                            <p>Configure parameters and click Generate to see preview</p>
                        </div>
                        <div id="report-content" class="hidden">
                            <div class="flex justify-between border-b dark:border-slate-700 pb-4 mb-6">
                                <div>
                                    <h2 id="view-report-name" class="font-bold text-xl uppercase tracking-tight text-blue-700 dark:text-blue-400">Monthly Governance Report</h2>
                                    <p class="text-sm font-semibold text-slate-500" id="view-report-district">Central Delhi District</p>
                                </div>
                                <div class="text-right text-[10px] text-gray-400 font-mono">ID: REF-DEL-2025-X</div>
                            </div>
                            
                            <div class="space-y-6">
                                <div class="p-4 bg-slate-50 dark:bg-slate-700/50 rounded-lg">
                                    <h5 class="text-xs font-bold text-slate-400 mb-2 uppercase tracking-widest">Executive Summary</h5>
                                    <p class="text-sm leading-relaxed" id="dynamic-summary">Analyzing data for the selected period...</p>
                                </div>
                                
                                <div class="grid grid-cols-2 gap-4">
                                    <div class="border dark:border-slate-700 p-4 rounded-lg">
                                        <p class="text-xs text-slate-400">Period Covered</p>
                                        <p class="text-sm font-bold mt-1" id="view-report-dates">Jan 01 - Jan 30</p>
                                    </div>
                                    <div class="border dark:border-slate-700 p-4 rounded-lg">
                                        <p class="text-xs text-slate-400">Resolution Rate</p>
                                        <p class="text-sm font-bold mt-1 text-green-600">88.4%</p>
                                    </div>
                                </div>

                                <div class="h-32 border border-dashed dark:border-slate-700 rounded-lg flex items-center justify-center italic text-xs text-slate-400">
                                    [Simulated Data Visualizations Attached]
                                </div>
                            </div>

                            <div class="absolute bottom-8 right-8 flex gap-3">
                                <button class="bg-white dark:bg-slate-700 border dark:border-slate-600 text-gray-600 dark:text-slate-200 px-4 py-2 rounded-lg text-sm font-bold flex items-center gap-2"><i data-lucide="download" class="w-4 h-4"></i> Excel</button>
                                <button class="bg-red-500 text-white px-4 py-2 rounded-lg text-sm font-bold flex items-center gap-2"><i data-lucide="file-type-2" class="w-4 h-4"></i> Download PDF</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

    </main>

    <script>
        // Initialize Icons
        lucide.createIcons();

        // 1. DARK MODE TOGGLE
        function toggleDarkMode() {
            document.documentElement.classList.toggle('dark');
        }

        // 2. DATE RANGE TOGGLE
        function toggleDateRange(days) {
            const btn30 = document.getElementById('range-30');
            const btn90 = document.getElementById('range-90');
            
            if(days === 30) {
                btn30.className = "px-4 py-1 text-sm bg-blue-50 text-blue-600 dark:bg-blue-900 dark:text-blue-200 rounded-md font-medium transition-all";
                btn90.className = "px-4 py-1 text-sm text-gray-500 dark:text-slate-400 transition-all";
            } else {
                btn90.className = "px-4 py-1 text-sm bg-blue-50 text-blue-600 dark:bg-blue-900 dark:text-blue-200 rounded-md font-medium transition-all";
                btn30.className = "px-4 py-1 text-sm text-gray-500 dark:text-slate-400 transition-all";
            }
        }

        // 3. GENERATE LIVE REPORT
        function generateLiveReport() {
            const district = document.getElementById('reportDistrict').value;
            const name = document.getElementById('reportName').value;
            const start = document.getElementById('reportDateStart').value;
            const end = document.getElementById('reportDateEnd').value;

            const emptyState = document.getElementById('empty-report-state');
            const content = document.getElementById('report-content');
            
            emptyState.innerHTML = `
                <div class="flex flex-col items-center">
                    <div class="animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mb-4"></div>
                    <p class="text-sm font-medium animate-pulse">Compiling analytics for ${district}...</p>
                </div>
            `;

            setTimeout(() => {
                emptyState.classList.add('hidden');
                content.classList.remove('hidden');
                
                document.getElementById('view-report-name').innerText = name;
                document.getElementById('view-report-district').innerText = district + " Administrative Area";
                document.getElementById('view-report-dates').innerText = `${start} to ${end}`;
                document.getElementById('dynamic-summary').innerText = `During the period from ${start} to ${end}, the ${district} district recorded a total of 1,240 civilian complaints. AI-analysis indicates that sanitation remains the highest priority cluster in Ward 4.`;
                
                lucide.createIcons();
            }, 1200);
        }

        function animateValue(id, start, end, duration) {
            const obj = document.getElementById(id);
            if (!obj) return;
            let startTimestamp = null;
            const step = (timestamp) => {
                if (!startTimestamp) startTimestamp = timestamp;
                const progress = Math.min((timestamp - startTimestamp) / duration, 1);
                obj.innerHTML = Math.floor(progress * (end - start) + start).toLocaleString();
                if (progress < 1) window.requestAnimationFrame(step);
            };
            window.requestAnimationFrame(step);
        }

        function triggerDashboardStats() {
            animateValue("stat-total", 0, 4280, 1500);
            animateValue("stat-priority", 0, 142, 1500);
            animateValue("stat-schemes", 0, 24, 1500);
        }

        function runAISimulation() {
            const container = document.getElementById("ai-text-container");
            const card = document.getElementById("ai-card");
            card.classList.add("opacity-50");
            container.innerHTML = `<div class="flex items-center gap-3 py-4"><div class="animate-spin rounded-full h-4 w-4 border-b-2 border-blue-700"></div><p class="text-sm text-blue-700 dark:text-blue-300 font-medium">ANALYZING COMPLAINT CLUSTERS...</p></div>`;
            setTimeout(() => {
                card.classList.remove("opacity-50");
                container.innerHTML = `<p class="text-gray-700 dark:text-slate-300 text-sm italic leading-relaxed animate-in fade-in duration-700">"Data shows a sudden 22% spike in 'Water Contamination' complaints near Vikas Marg. Recommending immediate inspection."</p>`;
            }, 1500);
        }

        function filterComplaints() {
            const input = document.getElementById("complaintSearch").value.toUpperCase();
            const tr = document.getElementById("complaintsTable").getElementsByTagName("tr");
            for (let i = 1; i < tr.length; i++) {
                tr[i].style.display = tr[i].innerText.toUpperCase().indexOf(input) > -1 ? "" : "none";
            }
        }

        function showPage(pageId) {
            document.querySelectorAll('.page-section').forEach(s => s.classList.add('hidden'));
            document.getElementById('page-' + pageId).classList.remove('hidden');

            const titles = {
                'overview': 'Policymaker Analytics Dashboard',
                'grievances': 'Complaints Analysis & Insights',
                'impact': 'Policy & Scheme Performance',
                'reports': 'Report Generation Center'
            };
            
            document.getElementById('page-title').innerText = titles[pageId];
            
            document.querySelectorAll('nav button').forEach(b => b.classList.remove('nav-active'));
            document.getElementById('btn-' + pageId).classList.add('nav-active');
            
            if(pageId === 'overview') triggerDashboardStats();
            lucide.createIcons();
        }

        window.onload = () => {
            triggerDashboardStats();
            
            // --- INTERACTIVE CHART SECTION (UPDATED) ---
            new Chart(document.getElementById('overviewChart'), {
                type: 'line',
                data: { 
                    labels: ['M', 'T', 'W', 'T', 'F', 'S', 'S'], 
                    datasets: [{ 
                        label: 'Total Complaints', 
                        data: [65, 59, 80, 81, 56, 40, 45], 
                        borderColor: '#2563eb', 
                        tension: 0.4 
                    }] 
                },
                options: { 
                    plugins: { 
                        legend: { display: true } // LEGEND ENABLED
                    } 
                }
            });

            new Chart(document.getElementById('categoryChart'), {
                type: 'doughnut',
                data: { 
                    labels: ['Water/Sewerage', 'Street Light/Power', 'Roads/Potholes', 'Garbage/Sanitation', 'Horticulture/Parks', 'Illegal Construction'], 
                    datasets: [{ 
                        data: [40, 15, 10, 15, 15, 5], 
                        backgroundColor: ['#2563eb', '#3b82f6', '#93c5fd', '#1043b3', '#1555e2', '#5484ef'], 
                        borderWidth: 0 
                    }] 
                },
                options: {
                    plugins: {
                        legend: { display: true } // LEGEND ENABLED
                    }
                }
            });

            new Chart(document.getElementById('impactChart'), {
                type: 'bar',
                data: { 
                    labels: ['East', 'West', 'North', 'South'], 
                    datasets: [
                        { label: 'Before Scheme', data: [120, 150, 140, 180], backgroundColor: '#cbd5e1' }, 
                        { label: 'After Scheme', data: [80, 90, 100, 110], backgroundColor: '#22c55e' }
                    ] 
                },
                options: {
                    plugins: {
                        legend: { display: true } // LEGEND ENABLED
                    }
                }
            });
        };
    </script>
    <script src="jansetu-assistant.js"></script>
</body>
</html>